# IoT 機械手臂與相機系統說明

此系統結合 Raspberry Pi、機械手臂與相機，實現以下功能：
- 使用超聲波傳感器檢測物體距離。
- 拍攝圖片並傳遞至伺服器進行分類。
- 根據分類結果，驅動機械手臂將物體移動至指定位置。
- 支援 TCP 通信與 Arduino 串口通信。

---

## 文件結構

```
project/
├── camera.py    # 負責相機與物體檢測的邏輯
├── robot.py     # 負責機械手臂操作的邏輯
```

---

## 功能說明

### 1. **camera.py**

#### 核心功能
- **超聲波測距**：
  - 使用 GPIO 控制超聲波傳感器測量物體距離。
  - 判斷物體是否穩定進入拍攝範圍。
- **相機拍攝與存儲**：
  - 利用 `Picamera2` 拍攝物體圖片。
  - 圖片按照時間戳命名並存儲於指定資料夾。
- **TCP 通信**：
  - 啟動 TCP 伺服器，向 Unity 或其他客戶端傳遞指令。
- **Arduino 控制**：
  - 通過串口向 Arduino 傳遞指令，控制外部設備。

#### 使用方式
- 啟動後，自動檢測物體並進行拍攝。
- 通過超聲波測距檢測物體是否已移除。
- 通過 TCP 向其他設備傳遞指令。

### 2. **robot.py**

#### 核心功能
- **機械手臂控制**：
  - 使用 Adafruit ServoKit 驅動 16 通道舵機。
  - 根據分類結果，將物體移動至對應位置。
- **TCP 通信**：
  - 啟動 TCP 伺服器，接收分類結果並觸發相應動作。
- **穩定性檢測**：
  - 使用超聲波檢測物體位置穩定性。
- **狀態機操作**：
  - 包括 RESET、CHECK、MOVE 和 WAIT 狀態，控制機械手臂操作流程。

#### 使用方式
- 啟動後，等待分類指令。
- 根據分類指令，操作機械手臂完成分類任務。

---

## 系統依賴

### 1. 硬體
- Raspberry Pi (安裝 Raspbian 或其他相容系統)
- 超聲波傳感器 (TRIG 和 ECHO 接口)
- 機械手臂 (支援舵機控制)
- Arduino (串口通信)

### 2. 軟體
- Python 版本：3.8 或以上
- 所需套件：
  ```bash
  pip install picamera2 adafruit-circuitpython-servokit
  ```

---

## TCP 通信

### camera.py
- **伺服器地址**：`IP`
- **通訊端口**：
  - `5002` 用於指令傳遞。

### robot.py
- **伺服器地址**：`IP`
- **通訊端口**：
  - `5000` 用於分類結果接收。
  - `5003` 用於指令傳遞。

---

## 使用方式

### 1. 啟動 camera.py

在 Raspberry Pi 上運行 `camera.py`：

```bash
python camera.py
```

### 2. 啟動 robot.py

在 Raspberry Pi 上運行 `robot.py`：

```bash
python robot.py
```

### 3. 整體流程
- **物體檢測與拍攝**：
  - 當物體進入指定範圍且穩定時，拍攝圖片並存儲。
  - 傳遞分類結果給機械手臂。
- **機械手臂分類操作**：
  - 根據分類結果，將物體移動至對應位置。
  - 返回初始位置，準備下一次操作。

---

## 注意事項

1. 確保硬體接線正確，避免損壞。
2. 檢查伺服器地址和端口是否配置正確。
3. 機械手臂動作範圍需與分類點對應，避免碰撞。

---

## 聯繫方式

如果有任何疑問，請聯繫：[您的姓名](mailto:您的郵箱)。
